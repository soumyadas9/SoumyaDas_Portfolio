<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>This is for you</title>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Poppins&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;font-family:Poppins;}
body{
  margin:0;
  height:100vh;
  background:
    radial-gradient(circle at top,#3b1c5a,#160a2b,#050012);
  display:flex;
  justify-content:center;
  align-items:center;
  overflow:hidden;
}

#scene{position:relative;text-align:center;width:100%;height:100%;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
}


/* Locker & gift box */
#hint{font-style:italic;color:#eee;margin-bottom:10px;}
#locker input{width:42px;height:52px;font-size:28px;margin:0 4px;border-radius:8px;border:none;text-align:center;}
#giftBox{position:relative;width:180px;height:140px;margin:25px auto;}
.box{width:180px;height:120px;background:#ff5f7e;border-radius:12px;position:absolute;bottom:0;}
.lid{width:190px;height:40px;background:#ff8fa3;border-radius:12px;position:absolute;top:-10px;left:-5px;}
.ribbon{width:30px;height:120px;background:#ffd166;position:absolute;left:75px;}
.bow{width:50px;height:30px;background:#ffd166;border-radius:50%;position:absolute;top:-30px;left:65px;}
.bounce{animation:bounce .6s;} @keyframes bounce{50%{transform:translateY(-25px)}}
.explode{animation:explode .7s forwards;} @keyframes explode{to{transform:scale(0);opacity:0}}
#message{font-family:Pacifico;font-size:48px;color:white;position:absolute;top:45%;left:-100%;display:none;white-space:nowrap;animation:slideText 12s forwards;}
@keyframes slideText{to{left:110%}}
.confetti{position:absolute;width:10px;height:10px;animation:fall 3s linear infinite;}
@keyframes fall{to{transform:translateY(110vh) rotate(360deg)}}
.balloon{position:absolute;width:40px;height:55px;border-radius:50%;animation:rise 6s linear infinite;}
@keyframes rise{from{bottom:-80px}to{bottom:110vh}}

/* Cookie stage */
#cookieStage{position:absolute;inset:0;background:rgba(0,0,0,.15);display:none;flex-direction:column;justify-content:center;align-items:center;}
#cookieText{font-size:28px;color:#eee;margin-bottom:20px;}
#cookie{width:140px;height:100px;background:#f4c27a;border-radius:70px 70px 40px 40px;cursor:pointer;}
.zoomIn{animation:zoom 1s forwards;} @keyframes zoom{from{transform:scale(0)}to{transform:scale(1)}}
.crack1{box-shadow:inset 0 0 0 3px #d49b55;}
.crack2{box-shadow:inset 0 0 0 3px #d49b55,inset 10px 10px 0 #c38a4a;}
.broken{animation:break .6s forwards;} @keyframes break{to{opacity:0;transform:scale(.8) rotate(20deg)}}
#note{width:260px;background:white;padding:20px;border-radius:10px;margin-top:20px;display:none;animation:slideUp 1s forwards;}
@keyframes slideUp{from{transform:translateY(50px);opacity:0}to{transform:translateY(0);opacity:1}}

/* Upgrade stage */
#upgradeStage{position:absolute;inset:0;background:#05070d;display:none;flex-direction:column;justify-content:center;align-items:center;color:#00ffd5;font-family:'Courier New', monospace;}
#systemText{font-size:24px;margin-bottom:25px;}
#progressContainer{width:60%;height:26px;border:2px solid #00ffd5;}
#progressBar{height:100%;width:0%;background:#00ffd5;transition:width .3s;}
#finalMessage{font-size:32px;display:none;text-align:center;margin-top:30px;}

/* Wheel stage */
#fateStage, #cardStage{position:absolute;inset:0;display:none;justify-content:center;align-items:center;flex-direction:column;color:white;}
#fateTitle{font-size:32px;margin-bottom:30px;}
#wheelContainer{position:relative;}
#wheel{width:260px;height:260px;border-radius:50%;background:conic-gradient(#ff6f91 0deg 60deg,#ffc75f 60deg 120deg,#845ec2 120deg 180deg,#00c9a7 180deg 240deg,#f9f871 240deg 300deg,#ff9671 300deg 360deg);display:flex;justify-content:center;align-items:center;font-size:48px;position:relative;}
#wheelCard{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:white;color:#111;font-size:32px;padding:30px 40px;border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:999;box-shadow:0 0 20px rgba(0,0,0,0.5);transition:transform 0.6s ease-out,opacity 0.6s ease-out;opacity:0;}
#wheelCard.show{transform:translate(-50%,-50%) scale(1);opacity:1;}
#spinBtn{margin-top:20px;padding:12px 28px;font-size:16px;border:none;background:#00ffd5;cursor:pointer;}

/* Card stage */
#cardGrid{display:grid;grid-template-columns:repeat(4,90px);gap:20px;justify-items:center;}
#selectedCardName{font-size:28px;margin-bottom:20px;}
.card{width:90px;height:130px;perspective:600px;cursor:pointer;}
.cardInner{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform 0.6s;}
.cardFront,.cardBack{position:absolute;width:100%;height:100%;border-radius:10px;display:flex;justify-content:center;align-items:center;backface-visibility:hidden;font-size:32px;}
.cardFront{background:#222;color:#eee;;font-size:24px}
.cardBack{
background:white;color:black;transform:rotateY(180deg);
font-weight:bold;
}
.corner{
position:absolute;font-size:14px;
}
.top{top:6px;left:6px}
.bottom{bottom:6px;right:6px;transform:rotate(180deg)}
.centerSuit{font-size:36px}

.cardInner.flipped{transform:rotateY(180deg);}
.cardFly{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);transition:transform 0.6s,opacity 0.6s;z-index:999;font-size:48px;padding:40px;border-radius:12px;background:white;color:#000;display:flex;align-items:center;justify-content:center;opacity:0;}
.cardFly.show{transform:translate(-50%,-50%) scale(1);opacity:1;}
#quizStage{
  position:absolute;
  inset:0;
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:white;
}

#quizBox{
  background:rgba(0,0,0,0.25);
  padding:30px;
  border-radius:16px;
  width:70%;
  max-width:500px;
  animation:fadePop .6s;
}

#quizBox h2{margin-bottom:20px}

.quizOption{
  background:#eee;;
  color:#000;
  padding:12px;
  margin:10px 0;
  border-radius:8px;
  cursor:pointer;
  transition:.2s;
}
.quizOption:hover{transform:scale(1.05)}

@keyframes fadePop{
  from{opacity:0;transform:scale(.8)}
  to{opacity:1;transform:scale(1)}
}

/* Quiz */
#quizStage{position:absolute;inset:0;display:none;justify-content:center;align-items:center}
#quizBox{background:white;padding:40px;border-radius:16px;width:70%;max-width:700px;animation:fadePop .6s}
.quizOption{margin:12px;padding:12px;border-radius:10px;background:#eee;cursor:pointer;transition:.3s}
.quizOption:hover{background:#ffd1dc}
@keyframes fadePop{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}

/* Grapes */
#grapeStage{position:absolute;inset:0;display:none;flex-direction:column;align-items:center}
#grapeTitle{font-size:32px;margin:30px}
#grapeGrid{display:grid;grid-template-columns:repeat(3,80px);gap:25px}
.grape{width:80px;height:80px;border-radius:50%;background:radial-gradient(circle,#a64ac9,#5c2a9d);cursor:pointer;animation:pop .4s}
@keyframes pop{from{transform:scale(0)}to{transform:scale(1)}}
#grapeReveal{position:absolute;bottom:40px;background:white;padding:20px;border-radius:14px;display:none;width:60%;text-align:center}

#quizBox{
  background:#0f1220;
  color:#f2f4ff;
  box-shadow:0 0 30px rgba(0,0,0,0.5);
}

.quizOption{
  background:#1c2040;
  color:#eee;;
}

.quizOption:hover{
  background:#ff5f7e;
  transform:scale(1.04);
}
.grape.popped { animation: grapePop .3s; }
@keyframes grapePop {
  50% { transform: scale(1.3); }
}


@keyframes burst{
  to{transform:scale(0);opacity:0}
}

#revealCard{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  justify-content:center;
  align-items:center;
}

#revealInner{
  background:white;
  padding:40px;
  border-radius:18px;
  max-width:600px;
  text-align:center;
  animation:popCard .5s;
}

@keyframes popCard{
  from{transform:scale(.4);opacity:0}
  to{transform:scale(1);opacity:1}
}
#wheelContainer {
  position: relative;
}

#pointer {
  position: absolute;
  top: -12px;
  left: 50%;
  transform: translateX(-50%);
  width: 0;
  height: 0;
  border-left: 14px solid transparent;
  border-right: 14px solid transparent;
  border-bottom: 26px solid gold;
  z-index: 10;
}

#wheel {
  width:260px;
  height:260px;
  border-radius:50%;
  position:relative;
  border:6px solid gold;
  background:conic-gradient(
    #ff6f91 0deg 60deg,
    #ffc75f 60deg 120deg,
    #845ec2 120deg 180deg,
    #00c9a7 180deg 240deg,
    #f9f871 240deg 300deg,
    #ff9671 300deg 360deg
  );
  transition: transform 4s cubic-bezier(.17,.67,.24,1);
  transition-timing-function: cubic-bezier(0.1, 0, 0, 1);
}

.slice {
  position: absolute;
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  transform-origin: 50% 50%;
}

.slice span {
  font-size: 32px;
  margin-top: 12px;
  display: block;
  transform: rotate(30deg);
}

.slice:nth-child(1) { transform: rotate(0deg); }
.slice:nth-child(2) { transform: rotate(60deg); }
.slice:nth-child(3) { transform: rotate(120deg); }
.slice:nth-child(4) { transform: rotate(180deg); }
.slice:nth-child(5) { transform: rotate(240deg); }
.slice:nth-child(6) { transform: rotate(300deg); }
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,.12), transparent 40%),
    radial-gradient(circle at 80% 70%, rgba(255,255,255,.12), transparent 40%);
  animation: breathe 10s ease-in-out infinite;
  z-index:-1;
}

@keyframes breathe{
  0%,100%{opacity:.6}
  50%{opacity:1}
}
.particle{
  position:absolute;
  width:6px;
  height:6px;
  background:rgba(255,255,255,.7);
  border-radius:50%;
  pointer-events:none;
  animation: float 12s linear infinite;
}

@keyframes float{
  from{transform:translateY(110vh) scale(.4)}
  to{transform:translateY(-20vh) scale(1)}
}

#wheel{
  box-shadow:
    0 0 40px rgba(255,215,0,.6),
    0 0 80px rgba(255,105,180,.4);
}
.destinyPulse{
  animation:pulseGlow 2s infinite;
}

@keyframes pulseGlow{
  0%,100%{box-shadow:0 0 20px gold}
  50%{box-shadow:0 0 50px hotpink}
}
#revealInner img{
  animation: floatUp 3s ease-in-out infinite;
  box-shadow:0 0 40px rgba(255,215,0,.6);
}

@keyframes floatUp{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
}
.cardFly.show{
  box-shadow:
    0 0 30px rgba(255,215,0,.8),
    0 0 60px rgba(255,105,180,.6);
}
#newYearBg{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:120px;
  color:rgba(255,255,255,.06);
  z-index:0;
  pointer-events:none;
}
.grape-card {
  background: rgba(255, 255, 255, 0.08);
  border-radius: 20px;
  padding: 18px;
  margin: 12px;
  min-width: 90px;
  text-align: center;
  cursor: pointer;
  backdrop-filter: blur(6px);
  box-shadow: 
  0 0 12px rgba(160, 100, 255, 0.4),
  0 0 25px rgba(200, 140, 255, 0.25),
  inset 0 0 10px rgba(255,255,255,0.15);

  transition: all 0.3s ease;
  animation: floatIn 0.6s ease forwards;
}

.grape-card:hover {
  transform: translateY(-6px) scale(1.05);
  box-shadow: 0 0 28px rgba(200, 140, 255, 0.7);
}

@keyframes floatIn {
  from {
    opacity: 0;
    transform: translateY(20px) scale(0.9);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}
.grape-result {
  background: white;
  color: #111;
  border-radius: 18px;
  padding: 22px 26px;
  min-width: 200px;
  text-align: center;

  box-shadow:
    0 12px 25px rgba(0,0,0,0.15),
    0 0 25px rgba(190,130,255,0.25);

  animation: grapeReveal 0.5s ease forwards;
}

@keyframes grapeReveal {
  from {
    opacity: 0;
    transform: scale(0.7) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}
.grape-result {
  background: linear-gradient(145deg, #ffffff, #fff7d1);
  color: #111;
  border-radius: 20px;
  padding: 24px 28px;
  min-width: 220px;
  text-align: center;

  box-shadow:
    0 15px 30px rgba(0,0,0,0.15),
    0 0 30px rgba(255, 215, 120, 0.6),
    0 0 60px rgba(190,130,255,0.25);

  animation: grapeReveal 0.5s ease forwards;
}

@keyframes grapeReveal {
  from {
    opacity: 0;
    transform: scale(0.7) translateY(25px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}
#grapeReveal h2 {
  margin-bottom: 12px;
  font-size: 26px;
  color: #5c2a9d;
}
#grapeReveal p {
  font-size: 18px;
}

</style>
</head>

<body>
<div id="scene">
<audio id="cookieSound" src="sounds/crunch.mp3"></audio>
<audio id="upgradeSound" src="sounds/upgrade.mp3"></audio>
<audio id="revealSound" src="sounds/reveal.mp3"></audio>
<audio id="spinSound" src="sounds/spin.mp3"></audio>
<audio id="bgMusic" src="sounds/bgmusic.mp3" loop></audio>



<!-- Locker -->
<div id="hint">Enter "code" for demo</div>
<div id="locker">
<input maxlength="1"><input maxlength="1"><input maxlength="1"><input maxlength="1">
</div>
<div id="giftBox"><div class="lid"></div><div class="box"></div><div class="ribbon"></div><div class="bow"></div></div>
<div id="message">This is for you!</div>

<!-- Cookie stage -->
<div id="cookieStage">
<div id="cookieText">Break open the cookie to reveal your fortune</div>
<div id="cookie"></div>
<div id="note"></div>
</div>

<!-- Upgrade stage -->
<div id="upgradeStage">
<div id="systemText"></div>
<div id="progressContainer"><div id="progressBar"></div></div>
<div id="finalMessage">UPGRADE COMPLETE.<br>You are now ready for 2026.</div>
</div>

<!-- Wheel stage -->
<div id="fateStage">
<div id="fateTitle">Spin the Wheel of Fate</div>
<div id="wheelContainer">

  <div id="pointer"></div>

  <div id="wheel">
    <div class="slice"><span>üêâ</span></div>
    <div class="slice"><span>ü¶ö</span></div>
    <div class="slice"><span>üòá</span></div>
    <div class="slice"><span>üî•</span></div>
    <div class="slice"><span>üåô</span></div>
    <div class="slice"><span>‚≠ê</span></div>

  </div>
</div>


  <button id="spinBtn">SPIN</button>
</div>
<div id="wheelCard"></div>
</div>

<!-- Card stage -->
<div id="cardStage">
<div id="selectedCardName"></div>
<div id="cardTitle" style="font-size:24px;margin-bottom:15px;color:#eee;font-family:Poppins;">Pick a card.</div>

<div id="cardGrid"></div>
<div id="cardFly" class="cardFly"></div>
</div>
<!-- QUIZ STAGE -->
<div id="quizStage">
  <div id="quizTitle" style="font-size:24px;margin-bottom:15px;color:#eee;font-family:Poppins;">Your answers decide your fate</div>

  <div id="quizBox"></div>
</div>
<!-- Quiz stage -->
<div id="quizStage">
  <div id="quizBox"></div>
</div>

<!-- Grapes stage -->
<div id="grapeStage">
  <div id="newYearBg">HAPPY NEW YEAR</div>

  <div id="grapeTitle">Eating 12 grapes is too mainstream.</div>
  <div id="grapeSubtitle" style="font-size:18px;color:#ddd;margin-bottom:20px;">Let's pop 12 grapes!</div>

  <div id="grapeGrid"></div>
  <div id="grapeReveal"></div>
</div>

<div id="revealCard">
  <div id="revealInner"></div>
</div>

</div>

<script>
// ===== MAGIC SOUND ENGINE =====
const sounds = {
  click: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-mouse-click-close-1113.mp3"),
  sparkle: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-magic-sweep-game-trophy-257.mp3"),
  explosion: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-fairy-arcade-sparkle-866.mp3"),
  cookieTap: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-crunchy-bite-2344.mp3"),
  cookieBreak: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-hard-pop-click-2364.mp3"),
  upgrade: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-tech-click-1140.mp3"),
  wheelSpin: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-fast-rocket-whoosh-1714.mp3"),
  reveal: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-magic-glitter-2629.mp3"),
  grape: new Audio("https://assets.mixkit.co/sfx/preview/mixkit-arcade-mechanical-bling-210.wav")
};

function playSound(name){
  sounds[name].currentTime = 0;
  sounds[name].play();
}

  // === PLAYER PROFILE ===
let chosenSymbol = "";
let chosenCard = "";
const symbols = [
  { emoji: "üêâ", name: "Dragon" },
  { emoji: "ü¶ö", name: "Peacock" },
  { emoji: "üòá", name: "Angel" },
  { emoji: "üî•", name: "Fire" },
  { emoji: "üåô", name: "Moon" },
  { emoji: "‚≠ê", name: "Star" }
];
function spawnParticles(){
  for(let i=0;i<40;i++){
    const p=document.createElement("div");
    p.className="particle";
    p.style.left=Math.random()*100+"vw";
    p.style.animationDelay=Math.random()*12+"s";
    document.body.appendChild(p);
  }
}
spawnParticles();


let playerProfile = {
  confidence: 0,
  peace: 0,
  ambition: 0,
  love: 0
};
const fateMeaning = {
  Dragon: "You are stepping into a powerful leadership phase this year.",
  Peacock: "Your confidence and self-worth will rise strongly.",
  Angel: "You are protected and guided through major decisions.",
  Fire: "This year awakens fierce ambition and unstoppable drive.",
  Moon: "Deep emotional healing and intuition will shape your path.",
  Star: "Unexpected opportunities and recognition are coming your way."
};

const cardMeaning = {
  "Queen of Hearts": 
    "A phase of emotional growth where you understand your feelings better and stop settling for less in love, both for yourself and in relationships.",

  "King of Spades": 
    "A time of mental strength and smart decision-making. You‚Äôll start seeing situations clearly and making moves that actually work in your favor.",

  "Ace of Diamonds": 
    "Fresh financial opportunities and new beginnings around work, money, or personal goals, something that helps you build long-term stability.",

  "Jack of Clubs": 
    "New connections, ideas, and creative projects entering your life. Expect unexpected collaborations and chances to explore new sides of yourself."
};


function generateTheme(){
  let word = playerProfile.confidence > 3 ? "REBIRTH" : 
             playerProfile.peace > 3 ? "BALANCE" : 
             playerProfile.ambition > 3 ? "ASCENT" : "TRANSFORMATION";

  let sentence = `The lesson 2026 will teach you: ${word} ‚Äî learning to trust yourself and your journey.`;
  return `<h2>${word}</h2><p>${sentence}</p>`;
}
function generateCharacterImage() {
  const profile = generateCharacterProfile();
  let imgUrl = "";

  // Base images by core trait
  if(profile.coreTrait === "ambition") imgUrl = "images/ambitious.png";
  else if(profile.coreTrait === "love-driven") imgUrl = "images/love.png";
  else if(profile.coreTrait === "serenity") imgUrl = "images/peace.png";
  else if(profile.coreTrait === "confident achiever") imgUrl = "images/confident.png";
  else imgUrl = "images/default.png";

  return imgUrl;
}
function getCharacterTitle() {
  const profile = generateCharacterProfile();

  if(profile.coreTrait === "ambition") return "Relentless Dreamer";
  if(profile.coreTrait === "love-driven") return "Heart-Led Soul";
  if(profile.coreTrait === "serenity") return "Quiet Strength";
  if(profile.coreTrait === "confident achiever") return "Unstoppable Force";

  return "Becoming";
}

function generateCharacterDesc() {
  const profile = generateCharacterProfile();

  let desc = `Meet your 2026 self:\n`;
  if(profile.job) desc += `Works at a ${profile.job}, `;
  if(profile.career) desc += `${profile.career}, `;
  if(profile.skill) desc += `skilled in ${profile.skill}, `;
  if(profile.personality) desc += `${profile.personality}, `;
  if(profile.vibe) desc += `${profile.vibe}, `;
  if(profile.lifestyle) desc += `living a ${profile.lifestyle} lifestyle, `;
  if(profile.relationship) desc += `while ${profile.relationship}. `;
  if(profile.goal) desc += `Driven by ${profile.goal}, `;
  if(profile.future) desc += `striving for ${profile.future}. `;
  if(profile.fear) desc += `Overcoming ${profile.fear}. `;
  if(profile.animalTrait) desc += `Embodies traits of a ${profile.animalTrait}.`;

  return desc;
}

function applyScore(qIndex, optionIndex){
  const map = [
    ["confidence","peace","love","peace"],
    ["peace","confidence","peace","love"],
    ["ambition","confidence","ambition","confidence"],
    ["peace","ambition","confidence","love"],
    ["ambition","confidence","love","confidence"],
    ["confidence","confidence","ambition","peace"],
    ["confidence","peace","ambition","love"],
    ["peace","ambition","love","confidence"],
    ["ambition","love","confidence","peace"],
    ["confidence","peace","confidence","love"],
    ["confidence","ambition","love","confidence","peace","love"]
  ];
  
  const trait = map[qIndex][optionIndex];
  if(trait) playerProfile[trait]++;
}


// Locker logic
const code="code";
const inputs=[...document.querySelectorAll("#locker input")];
const gift=document.getElementById("giftBox");
const message=document.getElementById("message");
const cookieStage=document.getElementById("cookieStage");
const cookie=document.getElementById("cookie");
const note=document.getElementById("note");
const fortunes = [
  "2026 will surprise you in the best way.",
  "Your hard work is about to pay off.",
  "Good things are quietly coming your way.",
  "This year will be softer, brighter, kinder.",
  
  // new ones
  "You‚Äôre exactly where you need to be right now.",
  "A small decision will change everything for the better.",
  "Success is finding you, even if you can‚Äôt see it yet.",
  "The next chapter is going to feel different, in a good way.",
  "Something you‚Äôve been hoping for is finally on its way."
];

let cracks=0;

inputs.forEach((el,i)=>{
el.addEventListener("input",()=>{
if(el.value && i<3)inputs[i+1].focus();
check();
});
});

function check() {
    // You must map the .value of each input element
    let attempt = inputs.map(i => i.value.toLowerCase()).join(""); 
    
    if (attempt === code) {
        const music = document.getElementById("bgMusic");
        music.volume = 0;
        music.play();

        let v = 0;
        const fade = setInterval(() => {
            if (v < 0.3) {
                v += 0.01;
                music.volume = v;
            } else {
                clearInterval(fade);
            }
        }, 100);

        playSound("sparkle");

        gift.classList.add("bounce");
        setTimeout(() => {
            playSound("explosion");

            gift.classList.add("explode");
            document.getElementById("locker").style.display = "none";
            document.getElementById("hint").style.display = "none";
            // gift.style.display = "none"; // Optional: explode animation handles this
            message.style.display = "block";
            celebrate();
            setTimeout(showCookie, 4500);
        }, 600);
    }
}

function celebrate(){
for(let i=0;i<80;i++){
let c=document.createElement("div");
c.className="confetti";
c.style.left=Math.random()*100+"vw";
c.style.top="-20px";
c.style.background=`hsl(${Math.random()*360},80%,60%)`;
document.body.appendChild(c);
}
for(let i=0;i<15;i++){
let b=document.createElement("div");
b.className="balloon";
b.style.left=Math.random()*100+"vw";
b.style.background=`hsl(${Math.random()*360},70%,65%)`;
document.body.appendChild(b);
}
}

function showCookie(){
message.style.display="none";
document.querySelectorAll(".confetti,.balloon").forEach(e=>e.remove());
cookieStage.style.display="flex";
cookie.classList.add("zoomIn");
}

cookie.addEventListener("click",()=>{
  document.getElementById("cookieSound").play();
  playSound("cookieTap");
  cracks++;
  if(cracks===1){
    playSound("cookieBreak");
    cookie.classList.add("crack1");}
  if(cracks===2){
    playSound("cookieBreak");
    cookie.classList.add("crack2");}
  
  if(cracks===3){
    playSound("cookieBreak");

    cookie.classList.add("broken");
    let chosen=fortunes[Math.floor(Math.random()*fortunes.length)];
    note.innerText=chosen;
    setTimeout(()=>note.style.display="block",400);
    setTimeout(startUpgrade,3500);
    }
});

// Upgrade stage
const upgradeStage=document.getElementById("upgradeStage");
const systemText=document.getElementById("systemText");
const progressBar=document.getElementById("progressBar");
const finalMessage=document.getElementById("finalMessage");
const systemMessages=["Removing self doubt...","Installing confidence...","Installing surprises...","Injecting unexpected miracles...","Optimizing courage...","Calibrating destiny...","Finalizing mindset..."];
function startUpgrade(){
document.getElementById("upgradeSound").loop = true;
document.getElementById("upgradeSound").play();

cookieStage.style.display="none";
upgradeStage.style.display="flex";
let progress=0;let msgIndex=0;
const interval=setInterval(()=>{
progress+=2;
progressBar.style.width=progress+"%";
if(progress%14===0 && msgIndex<systemMessages.length){
systemText.innerText=systemMessages[msgIndex++];
}
if(progress>=100){
document.getElementById("upgradeSound").pause();

clearInterval(interval);
systemText.style.display="none";
finalMessage.style.display="block";
setTimeout(()=>{
upgradeStage.style.display="none";
fateStage.style.display="flex";
},2000);
}
},120);
}

// Wheel logic
// ===== WHEEL LOGIC =====

const wheel = document.getElementById("wheel");
const spinBtn = document.getElementById("spinBtn");
const wheelCard = document.getElementById("wheelCard");

let spinning = false;
let currentRotation = 0;

spinBtn.onclick = () => {
  document.getElementById("spinSound").currentTime = 0;
  document.getElementById("spinSound").play();


  playSound("wheelSpin");

  if (spinning) return;
  spinning = true;

  const sliceAngle = 360 / symbols.length;
  const randomIndex = Math.floor(Math.random() * symbols.length);

  const targetAngle =
    (360 * 5) +
    (360 - (randomIndex * sliceAngle)) - (sliceAngle / 2);

  currentRotation = targetAngle;

  wheel.style.transform = `rotate(${currentRotation}deg)`;

  setTimeout(() => {
    chosenSymbol = symbols[randomIndex].name;

    wheelCard.innerHTML = `
      <div style="font-size:48px">${symbols[randomIndex].emoji}</div>
      <div style="margin-top:10px">${symbols[randomIndex].name}</div>
    `;
    playSound("reveal");
    wheelCard.classList.add("show","destinyPulse");

    setTimeout(() => {
      wheelCard.classList.remove("show");
      fateStage.style.display = "none";
      showCards();
    }, 2200);

    spinning = false;
  }, 4200);
};



// Card stage
function showCards(){
fateStage.style.display="none";
wheelCard.classList.remove("show");
cardStage.style.display="flex";
const selectedCardName=document.getElementById("selectedCardName");
const grid=document.getElementById("cardGrid");
const cardFly=document.getElementById("cardFly");
grid.innerHTML="";selectedCardName.innerText="";

const cards=[
{value:"Q",suit:"‚ô•",name:"Queen of Hearts"},
{value:"K",suit:"‚ô†",name:"King of Spades"},
{value:"A",suit:"‚ô¶",name:"Ace of Diamonds"},
{value:"J",suit:"‚ô£",name:"Jack of Clubs"}
];

cards.forEach(c=>{
const card=document.createElement("div");card.className="card";card.classList.add("grape-card");
const inner=document.createElement("div");inner.className="cardInner";

const front=document.createElement("div");
front.className="cardFront";
front.innerHTML="?";

const back=document.createElement("div");
back.className="cardBack";
back.innerHTML=`
<div class="corner top">${c.value}</div>
<div class="centerSuit">${c.suit}</div>
<div class="corner bottom">${c.value}</div>
`;

inner.appendChild(front);
inner.appendChild(back);
card.appendChild(inner);

card.onclick=()=>{
inner.classList.add("flipped");
cardFly.innerHTML=back.innerHTML;
cardFly.classList.add("show");
selectedCardName.innerText = c.name;
chosenCard = c.name;

setTimeout(()=>{
  cardFly.classList.remove("show");
  setTimeout(startQuiz,600);
},1200);

};

grid.appendChild(card);
});
}
// ================= QUIZ SYSTEM =================

const quizStage = document.getElementById("quizStage");
const quizBox = document.getElementById("quizBox");

const quizQuestions = [
  { q:"What is the one thing you want more of this year?",
    options:["Stability & routine","Courage to take risks","Love & connection","Peace & calm"] },

  { q:"When it comes to your emotions, your top priority is:",
    options:["Less anxiety","Less fear in mind","Peace of mind","Feeling understood"] },

  { q:"In your career right now, what matters the most?",
    options:["Switching to a better job","Getting promoted / recognized","Building a side hustle","Discovering what I truly want"] },

  { q:"What kind of life are you secretly craving?",
    options:["Quiet & secure","Adventurous & exciting","Successful & respected","Creative & free"] },

  { q:"What scares you the most right now?",
    options:["Being stuck","Failing","Being alone","Not becoming who I could be"] },

  { q:"If you could instantly improve one skill, it would be:",
    options:["Confidence","Communication","Discipline","Emotional control"] },

  { q:"Which sentence feels closest to your heart?",
    options:["I want to feel proud of myself","I want to stop worrying","I want my life to change","I want to believe in myself again"] },

  { q:"What motivates you the most?",
    options:["Inner peace","Big dreams","Love & belonging","Proving myself"] },

  { q:"Which future sounds most exciting?",
    options:["Financial independence","Emotional fulfillment","Power & respect","Calm & content"] },

  { q:"When you imagine your best version, you see someone who is:",
    options:["Fearless","Calm","Confident","Deeply loved"] },

  { q:"Which animal do you identify with the most?",
    options:["ü¶Å Lion","üê∫ Wolf","ü¶ã Butterfly","ü¶Ö Eagle","ü¶â Owl","üê¨ Dolphin"] }
];

let quizIndex = 0;
const quizAnswers = [];

function startQuiz(){
  cardStage.style.display="none";
  quizStage.style.display="flex";
  quizIndex = 0;
  quizAnswers.length = 0;
  showQuestion();
}

function showQuestion(){
  const data = quizQuestions[quizIndex];
  quizBox.innerHTML = `<h2>${data.q}</h2>`;

  data.options.forEach((opt, index) => {
    const btn = document.createElement("div");
    btn.className = "quizOption";
    btn.innerText = opt;

    btn.onclick = () => {
      applyScore(quizIndex, index);
      quizAnswers.push(opt);
      quizIndex++;

      if(quizIndex < quizQuestions.length){
        quizBox.style.animation="none";
        quizBox.offsetHeight;
        quizBox.style.animation="fadePop .6s";
        showQuestion();
      } else {
        startGrapes();
      }
    };

    quizBox.appendChild(btn);
  });
}
const traitElements = {
  "Stability & routine": {job:"corporate job", vibe:"organized, focused"},
  "Courage to take risks": {job:"side hustle/startup", vibe:"bold, adventurous"},
  "Love & connection": {relationship:"loved by someone special", vibe:"warm, empathetic"},
  "Peace & calm": {personality:"calm and composed", vibe:"serene, reflective"},

  "Less anxiety": {personality:"mindful and relaxed"},
  "Less fear in mind": {personality:"courageous and confident"},
  "Peace of mind": {personality:"balanced and grounded"},
  "Feeling understood": {personality:"empathic, good listener"},

  "Switching to a better job": {career:"career transition underway"},
  "Getting promoted / recognized": {career:"rising at work"},
  "Building a side hustle": {career:"side hustle/entrepreneurial project"},
  "Discovering what I truly want": {career:"exploring passion projects"},

  "Quiet & secure": {lifestyle:"cozy, safe home"},
  "Adventurous & exciting": {lifestyle:"traveling, exploring"},
  "Successful & respected": {lifestyle:"well-known, accomplished"},
  "Creative & free": {lifestyle:"artistic, independent"},

  "Being stuck": {fear:"fear of stagnation"},
  "Failing": {fear:"fear of failure"},
  "Being alone": {fear:"fear of loneliness"},
  "Not becoming who I could be": {fear:"fear of underachieving"},

  "Confidence": {skill:"confident decision-maker"},
  "Communication": {skill:"eloquent and persuasive"},
  "Discipline": {skill:"organized and methodical"},
  "Emotional control": {skill:"calm under pressure"},

  "I want to feel proud of myself": {goal:"self-respect and pride"},
  "I want to stop worrying": {goal:"inner peace"},
  "I want my life to change": {goal:"transformation"},
  "I want to believe in myself again": {goal:"hope and optimism"},

  "Inner peace": {coreTrait:"serenity"},
  "Big dreams": {coreTrait:"ambition"},
  "Love & belonging": {coreTrait:"love-driven"},
  "Proving myself": {coreTrait:"confident achiever"},

  "Financial independence": {future:"wealth and freedom"},
  "Emotional fulfillment": {future:"emotional happiness"},
  "Power & respect": {future:"influence and recognition"},
  "Calm & content": {future:"balance and satisfaction"},

  "Fearless": {personality:"courageous and bold"},
  "Calm": {personality:"peaceful and composed"},
  "Confident": {personality:"self-assured"},
  "Deeply loved": {relationship:"surrounded by love"},

  "ü¶Å Lion": {animalTrait:"leader, brave"},
  "üê∫ Wolf": {animalTrait:"strategic, loyal"},
  "ü¶ã Butterfly": {animalTrait:"transformative, free"},
  "ü¶Ö Eagle": {animalTrait:"visionary, independent"},
  "ü¶â Owl": {animalTrait:"wise, introspective"},
  "üê¨ Dolphin": {animalTrait:"friendly, empathetic"}
};
function generateCharacterProfile() {
  let profile = {
    job: "", lifestyle:"", relationship:"", personality:"", career:"", skill:"", fear:"", goal:"", coreTrait:"", future:"", animalTrait:"", vibe:""
  };

  quizAnswers.forEach(ans => {
    if(traitElements[ans]){
      Object.assign(profile, traitElements[ans]);
    }
  });

  return profile;
}


// ================= GRAPES SYSTEM =================

const grapeStage = document.getElementById("grapeStage");
const grapeGrid = document.getElementById("grapeGrid");
const grapeReveal = document.getElementById("grapeReveal");

function startGrapes(){
  quizStage.style.display="none";
  grapeStage.style.display="flex";
  grapeGrid.innerHTML="";
  grapeReveal.style.display="none";

  for(let i=0;i<12;i++){
    setTimeout(()=>{
      const g=document.createElement("div");
      g.className="grape";
      g.onclick = (e) => openGrape(i+1, e);
      grapeGrid.appendChild(g);
    },i*150);
  }
  celebrate();

}

function openGrape(n, e){
  document.getElementById("revealSound").currentTime = 0;
  document.getElementById("revealSound").play();

  playSound("grape");

  const g = e.currentTarget;
  g.classList.add("popped");

  const revealCardDiv = document.getElementById("revealCard");
  const revealInner = document.getElementById("revealInner");

  // Reset & apply the magical card style
  revealInner.className = "";
  revealInner.classList.add("grape-result");

  let content = "";
  

  if (n == 1) {
  content = `
    <h2>Message from me üíå</h2>
    <p>Thank you for being a part of my life and making it so special, truly grateful to have a friend like you!</p>
  `;
}

  if (n == 2) {
  // Find the full symbol object from the array that matches the name saved by the wheel
  const symbolObj = symbols.find(s => s.name === chosenSymbol);
  
  // Safety check: if they haven't spun yet, or something went wrong
  const displayEmoji = symbolObj ? symbolObj.emoji : "‚ú®";
  const displayName = chosenSymbol || "Your Destiny";
  const meaning = fateMeaning[displayName] || "Your path is still unfolding.";

  content = `
    <h2>You chose the ${displayName} ${displayEmoji}</h2>
    <p>${meaning}</p>
  `;
}


  if (n == 3) {
  const meaning = cardMeaning[chosenCard];

  content = `
    <h2>You drew the ${chosenCard}</h2>
    <p>${meaning}</p>
  `;
}

  if (n == 4) {
  content = `
    <h2>Yearly Horoscope ‚ú®</h2>
    <p><strong>Based on your birthday: </strong></p>
    <p>This year is all about growth and self-discovery. New opportunities in career or studies may push you out of your comfort zone ‚Äî take them, even if they feel risky.</p>
    <p>By year‚Äôs end, you‚Äôll feel more confident, grounded, and aligned with your passions.</p>
  `;
}

  if (n == 5) {
  content = `
    <h2>Hidden Strength üí™</h2>
    <p>Your resilience and kindness. </p>
    <p> You do not let your weaknesses pull you down, but you convert them into your strengths. </p>
    
  `;
}

  if (n == 6) {
  content = `
    <h2>Your Path üîÆ</h2>
    <p>${
      playerProfile.ambition > playerProfile.peace 
      ? "Leadership & expansion."
      : "Inner peace & healing."
    }</p>
  `;
}


  if (n == 7) {
  content = `
    <h2>Fear to Release üïäÔ∏è</h2>
    <p><strong>Self-doubt.</strong></p>
    <p>Walk into rooms believing you are the most confident. </p>
  `;
}


  if (n == 8) {
  content = `
    <h2>Love Truth üíñ</h2>
    <p>You are the light you‚Äôve been searching for in others.</p>
    <p>You do not have to shrink to be loved. </p>
  `;
}


  if (n == 9) {
  content = `
    <h2>Your Theme üå†</h2>
    <p>${generateTheme()}</p>
  `;
}


  if (n == 10) {
  content = `
    <h2>Message from Future You ‚ú®</h2>
    <p>There were a thousand moments where you doubted yourself, felt beaten down, lost, overwhelmed, and burnt out, and yet you kept going.</p>
    <p>Everything is going to fall into place. You‚Äôve got this.</p>
  `;
}

  if(n==11){
    const imgUrl = generateCharacterImage();
    const title = getCharacterTitle();

    revealInner.innerHTML = `
      <h2 style="color:#ff5f7e; font-family:Pacifico; margin-bottom:15px;">${title}</h2>
      <img src="${imgUrl}" alt="Your 2026 Self" style="width:280px; border-radius:18px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); border: 4px solid #fff;">
      <p style="margin-top:15px; font-style:italic; color:#666;">This is the energy you are carrying into 2026.</p>
    `;
    revealCardDiv.style.display = "flex";
    return;
  }




  if(n==12) content = generateCharacterDesc();

  revealInner.innerHTML = content;
  revealCardDiv.style.display = "flex";
}



const revealCardDiv = document.getElementById("revealCard");

revealCardDiv.addEventListener("click", () => {
  revealCardDiv.style.display = "none";
});





</script>
</body>
</html>
